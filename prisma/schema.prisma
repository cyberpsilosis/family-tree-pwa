// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                    String   @id @default(cuid())
  firstName             String
  lastName              String
  birthYear             Int      // last two digits (99 = 1999)
  password              String   // hashed with bcrypt
  email                 String   @unique
  phone                 String?
  birthday              DateTime
  preferredContactMethod String? // "phone", "email", "text"
  instagram             String?
  facebook              String?
  twitter               String?
  linkedin              String?
  profilePhotoUrl       String?
  address               String?
  theme                 String   @default("light") // "light" or "dark"
  isAdmin               Boolean  @default(false)
  favoriteTeam          String?  // "49ers", "Raiders", "Other"
  customCardText        String?  // Custom text to display on card front
  
  // Family tree relationships
  parentId              String?
  parent                User?    @relation("FamilyTree", fields: [parentId], references: [id], onDelete: SetNull)
  children              User[]   @relation("FamilyTree")
  
  parent2Id             String?
  parent2               User?    @relation("FamilyTree2", fields: [parent2Id], references: [id], onDelete: SetNull)
  childrenAsParent2     User[]   @relation("FamilyTree2")
  
  friendId              String?
  friend                User?    @relation("Friendship", fields: [friendId], references: [id], onDelete: SetNull)
  friendOf              User[]   @relation("Friendship")
  
  createdAt             DateTime @default(now())
  updatedAt             DateTime @updatedAt
}

model Admin {
  id        String   @id @default(cuid())
  password  String   // hashed admin password
  email     String   @unique
  createdAt DateTime @default(now())
}

model Donation {
  id            String   @id @default(cuid())
  amount        Float    // donation amount in dollars
  donorName     String?  // optional donor name
  donorEmail    String?  // optional donor email
  stripePaymentId String @unique // Stripe payment intent ID
  status        String   @default("succeeded") // "succeeded", "pending", "failed"
  createdAt     DateTime @default(now())
}
